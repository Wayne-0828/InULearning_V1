<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API ä»£ç†æ¸¬è©¦</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { background: #f5f5f5; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .result { background: white; padding: 10px; margin: 10px 0; border-radius: 4px; border: 1px solid #ddd; }
        .success { border-color: #4caf50; background: #e8f5e8; }
        .error { border-color: #f44336; background: #ffebee; }
        button { padding: 10px 20px; margin: 5px; background: #2196f3; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #1976d2; }
        pre { background: #f8f8f8; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ” API ä»£ç†æ¸¬è©¦é é¢</h1>
    
    <div class="test-section">
        <h2>ğŸ“‹ æ¸¬è©¦èªªæ˜</h2>
        <p>é€™å€‹é é¢ç”¨ä¾†æ¸¬è©¦ API ä»£ç†æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚é»æ“Šä¸‹æ–¹æŒ‰éˆ•ä¾†æ¸¬è©¦ä¸åŒçš„ API ç«¯é»ã€‚</p>
    </div>

    <div class="test-section">
        <h2>ğŸ§ª API æ¸¬è©¦</h2>
        
        <button onclick="testAPI('/api/v1/relationships/teacher-class', 'æ•™å¸«ç­ç´šé—œä¿‚ï¼ˆä¸åŒ…å«å·²åˆªé™¤ï¼‰')">
            æ¸¬è©¦æ•™å¸«ç­ç´šé—œä¿‚
        </button>
        
        <button onclick="testAPI('/api/v1/relationships/teacher-class?include_deleted=true', 'æ•™å¸«ç­ç´šé—œä¿‚ï¼ˆåŒ…å«å·²åˆªé™¤ï¼‰')">
            æ¸¬è©¦å·²åˆªé™¤ç­ç´š
        </button>
        
        <button onclick="testAPI('/api/v1/relationships/teacher/removed-students', 'å·²ç§»é™¤å­¸ç”Ÿ')">
            æ¸¬è©¦å·²ç§»é™¤å­¸ç”Ÿ
        </button>
        
        <button onclick="testAPI('/api/v1/auth/health', 'èªè­‰æœå‹™å¥åº·æª¢æŸ¥')">
            æ¸¬è©¦èªè­‰æœå‹™
        </button>
        
        <button onclick="clearResults()">
            æ¸…é™¤çµæœ
        </button>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š æ¸¬è©¦çµæœ</h2>
        <div id="results"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ”§ æ‰‹å‹•æ¸¬è©¦</h2>
        <p>æ‚¨ä¹Ÿå¯ä»¥åœ¨ç€è¦½å™¨æ§åˆ¶å°ä¸­æ‰‹å‹•æ¸¬è©¦ï¼š</p>
        <pre>
// æ¸¬è©¦ API å®¢æˆ¶ç«¯
console.log('API å®¢æˆ¶ç«¯:', window.apiClient);

// æ¸¬è©¦ç›´æ¥è«‹æ±‚
fetch('/api/v1/relationships/teacher-class')
    .then(res => res.json())
    .then(data => console.log('ç›´æ¥è«‹æ±‚çµæœ:', data))
    .catch(err => console.error('ç›´æ¥è«‹æ±‚éŒ¯èª¤:', err));
        </pre>
    </div>

    <script>
        async function testAPI(endpoint, description) {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = 'result';
            resultDiv.innerHTML = `
                <h3>${description}</h3>
                <p><strong>ç«¯é»:</strong> ${endpoint}</p>
                <p><strong>ç‹€æ…‹:</strong> <span id="status-${Date.now()}">æ¸¬è©¦ä¸­...</span></p>
                <p><strong>çµæœ:</strong></p>
                <pre id="result-${Date.now()}">è¼‰å…¥ä¸­...</pre>
            `;
            resultsDiv.appendChild(resultDiv);
            
            const statusId = `status-${Date.now()}`;
            const resultId = `result-${Date.now()}`;
            
            try {
                console.log(`ğŸ” é–‹å§‹æ¸¬è©¦: ${endpoint}`);
                
                const response = await fetch(endpoint);
                const statusElement = document.getElementById(statusId);
                const resultElement = document.getElementById(resultId);
                
                console.log(`ğŸ“Š éŸ¿æ‡‰ç‹€æ…‹: ${response.status}`);
                
                if (response.ok) {
                    const data = await response.json();
                    statusElement.innerHTML = `<span style="color: green;">âœ… æˆåŠŸ (${response.status})</span>`;
                    resultElement.textContent = JSON.stringify(data, null, 2);
                    resultDiv.classList.add('success');
                } else {
                    const errorText = await response.text();
                    statusElement.innerHTML = `<span style="color: red;">âŒ å¤±æ•— (${response.status})</span>`;
                    resultElement.textContent = `éŒ¯èª¤: ${response.status} ${response.statusText}\n\n${errorText}`;
                    resultDiv.classList.add('error');
                }
                
            } catch (error) {
                console.error(`âŒ æ¸¬è©¦å¤±æ•—: ${endpoint}`, error);
                const statusElement = document.getElementById(statusId);
                const resultElement = document.getElementById(resultId);
                
                statusElement.innerHTML = `<span style="color: red;">âŒ éŒ¯èª¤</span>`;
                resultElement.textContent = `è«‹æ±‚å¤±æ•—: ${error.message}`;
                resultDiv.classList.add('error');
            }
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ API ä»£ç†æ¸¬è©¦é é¢å·²è¼‰å…¥');
            console.log('ç•¶å‰é é¢ URL:', window.location.href);
            console.log('API åŸºç¤è·¯å¾‘:', '/api/v1');
            
            // æª¢æŸ¥æ˜¯å¦æœ‰ API å®¢æˆ¶ç«¯
            if (window.apiClient) {
                console.log('âœ… æ‰¾åˆ° API å®¢æˆ¶ç«¯:', window.apiClient);
            } else {
                console.log('âŒ æœªæ‰¾åˆ° API å®¢æˆ¶ç«¯');
            }
        });
    </script>
</body>
</html>
