<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è©³ç´°æ¸¬è©¦å‡ºè€ƒå·åŠŸèƒ½</title>
</head>
<body>
    <h1>è©³ç´°æ¸¬è©¦å‡ºè€ƒå·åŠŸèƒ½</h1>
    
    <div>
        <h2>æ¨¡æ“¬çœŸå¯¦é é¢ç’°å¢ƒ</h2>
        <p>é€™å€‹é é¢æœƒè¼‰å…¥çœŸå¯¦çš„ JavaScript æ–‡ä»¶ä¾†æ¸¬è©¦åŠŸèƒ½</p>
    </div>
    
    <div style="margin: 20px 0;">
        <button onclick="testRealPage()">æ¸¬è©¦çœŸå¯¦é é¢è¼‰å…¥</button>
        <button onclick="testAssignmentsManager()">æ¸¬è©¦ AssignmentsManager</button>
        <button onclick="testQuizBuilder()">æ¸¬è©¦ QuizBuilder</button>
        <button onclick="testFullFlow()">æ¸¬è©¦å®Œæ•´æµç¨‹</button>
    </div>
    
    <div id="result"></div>

    <script>
        // æ¨¡æ“¬å¿…è¦çš„å…¨å±€è®Šæ•¸å’Œå‡½æ•¸
        window.showAlert = function(message, type) {
            console.log(`[${type.toUpperCase()}] ${message}`);
            document.getElementById('result').innerHTML = `
                <div style="color: ${type === 'error' ? 'red' : type === 'success' ? 'green' : 'blue'}; padding: 10px; border: 1px solid ${type === 'error' ? 'red' : type === 'success' ? 'green' : 'blue'};">
                    [${type.toUpperCase()}] ${message}
                </div>
            `;
        };

        window.showLoading = function() {
            console.log('é¡¯ç¤ºè¼‰å…¥ä¸­...');
        };

        window.hideLoading = function() {
            console.log('éš±è—è¼‰å…¥ä¸­...');
        };

        // æ¸¬è©¦çœŸå¯¦é é¢è¼‰å…¥
        async function testRealPage() {
            try {
                console.log('ğŸŒ æ¸¬è©¦çœŸå¯¦é é¢è¼‰å…¥...');
                
                // æª¢æŸ¥å¿…è¦çš„è…³æœ¬æ˜¯å¦è¼‰å…¥
                const requiredScripts = [
                    'utils.js',
                    'api-client.js', 
                    'auth.js',
                    'assignments-enhanced.js'
                ];
                
                let allScriptsLoaded = true;
                for (const script of requiredScripts) {
                    try {
                        const response = await fetch(`../js/${script}`);
                        if (response.ok) {
                            console.log(`âœ… ${script} è¼‰å…¥æˆåŠŸ`);
                        } else {
                            console.log(`âŒ ${script} è¼‰å…¥å¤±æ•—: ${response.status}`);
                            allScriptsLoaded = false;
                        }
                    } catch (error) {
                        console.log(`âŒ ${script} è¼‰å…¥å¤±æ•—:`, error.message);
                        allScriptsLoaded = false;
                    }
                }
                
                if (allScriptsLoaded) {
                    document.getElementById('result').innerHTML = `
                        <div style="color: green; padding: 10px; border: 1px solid green;">
                            âœ… æ‰€æœ‰è…³æœ¬è¼‰å…¥æˆåŠŸ<br>
                            è…³æœ¬æ•¸é‡: ${requiredScripts.length}
                        </div>
                    `;
                } else {
                    throw new Error('éƒ¨åˆ†è…³æœ¬è¼‰å…¥å¤±æ•—');
                }
                
            } catch (error) {
                console.error('âŒ çœŸå¯¦é é¢è¼‰å…¥æ¸¬è©¦å¤±æ•—:', error);
                document.getElementById('result').innerHTML = `
                    <div style="color: red; padding: 10px; border: 1px solid red;">
                        âŒ çœŸå¯¦é é¢è¼‰å…¥æ¸¬è©¦å¤±æ•—<br>
                        éŒ¯èª¤: ${error.message}
                    </div>
                `;
            }
        }

        // æ¸¬è©¦ AssignmentsManager
        async function testAssignmentsManager() {
            try {
                console.log('ğŸ“š æ¸¬è©¦ AssignmentsManager...');
                
                // æª¢æŸ¥ AssignmentsManager é¡æ˜¯å¦å­˜åœ¨
                if (typeof AssignmentsManager === 'function') {
                    console.log('âœ… AssignmentsManager é¡å­˜åœ¨');
                    
                    // å‰µå»ºå¯¦ä¾‹
                    const manager = new AssignmentsManager();
                    console.log('âœ… AssignmentsManager å¯¦ä¾‹å‰µå»ºæˆåŠŸ');
                    
                    document.getElementById('result').innerHTML = `
                        <div style="color: green; padding: 10px; border: 1px solid green;">
                            âœ… AssignmentsManager æ¸¬è©¦æˆåŠŸ<br>
                            é¡å­˜åœ¨: æ˜¯<br>
                            å¯¦ä¾‹å‰µå»º: æˆåŠŸ
                        </div>
                    `;
                } else {
                    throw new Error('AssignmentsManager é¡ä¸å­˜åœ¨');
                }
                
            } catch (error) {
                console.error('âŒ AssignmentsManager æ¸¬è©¦å¤±æ•—:', error);
                document.getElementById('result').innerHTML = `
                    <div style="color: red; padding: 10px; border: 1px solid red;">
                        âŒ AssignmentsManager æ¸¬è©¦å¤±æ•—<br>
                        éŒ¯èª¤: ${error.message}
                    </div>
                `;
            }
        }

        // æ¸¬è©¦ QuizBuilder
        function testQuizBuilder() {
            try {
                console.log('ğŸ“ æ¸¬è©¦ QuizBuilder...');
                
                // æª¢æŸ¥ QuizBuilder é¡æ˜¯å¦å­˜åœ¨
                if (typeof QuizBuilder === 'function') {
                    console.log('âœ… QuizBuilder é¡å­˜åœ¨');
                    
                    // æª¢æŸ¥ openQuizBuilder å‡½æ•¸æ˜¯å¦å­˜åœ¨
                    if (typeof openQuizBuilder === 'function') {
                        console.log('âœ… openQuizBuilder å‡½æ•¸å­˜åœ¨');
                        
                        document.getElementById('result').innerHTML = `
                            <div style="color: green; padding: 10px; border: 1px solid green;">
                                âœ… QuizBuilder æ¸¬è©¦æˆåŠŸ<br>
                                é¡å­˜åœ¨: æ˜¯<br>
                                å‡½æ•¸å­˜åœ¨: æ˜¯
                            </div>
                        `;
                    } else {
                        throw new Error('openQuizBuilder å‡½æ•¸ä¸å­˜åœ¨');
                    }
                } else {
                    throw new Error('QuizBuilder é¡ä¸å­˜åœ¨');
                }
                
            } catch (error) {
                console.error('âŒ QuizBuilder æ¸¬è©¦å¤±æ•—:', error);
                document.getElementById('result').innerHTML = `
                    <div style="color: red; padding: 10px; border: 1px solid red;">
                        âŒ QuizBuilder æ¸¬è©¦å¤±æ•—<br>
                        éŒ¯èª¤: ${error.message}
                    </div>
                `;
            }
        }

        // æ¸¬è©¦å®Œæ•´æµç¨‹
        async function testFullFlow() {
            try {
                console.log('ğŸ”„ æ¸¬è©¦å®Œæ•´æµç¨‹...');
                
                // 1. æª¢æŸ¥èªè­‰
                if (typeof teacherAuth === 'undefined') {
                    throw new Error('teacherAuth æœªå®šç¾©');
                }
                console.log('âœ… teacherAuth å­˜åœ¨');
                
                // 2. æª¢æŸ¥ apiClient
                if (typeof apiClient === 'undefined') {
                    throw new Error('apiClient æœªå®šç¾©');
                }
                console.log('âœ… apiClient å­˜åœ¨');
                
                // 3. æª¢æŸ¥ AssignmentsManager
                if (typeof AssignmentsManager === 'undefined') {
                    throw new Error('AssignmentsManager æœªå®šç¾©');
                }
                console.log('âœ… AssignmentsManager å­˜åœ¨');
                
                // 4. æª¢æŸ¥ QuizBuilder
                if (typeof QuizBuilder === 'undefined') {
                    throw new Error('QuizBuilder æœªå®šç¾©');
                }
                console.log('âœ… QuizBuilder å­˜åœ¨');
                
                document.getElementById('result').innerHTML = `
                    <div style="color: green; padding: 10px; border: 1px solid green;">
                        âœ… å®Œæ•´æµç¨‹æ¸¬è©¦æˆåŠŸ<br>
                        æ‰€æœ‰å¿…è¦çµ„ä»¶éƒ½å­˜åœ¨<br>
                        å‡ºè€ƒå·åŠŸèƒ½æ‡‰è©²å¯ä»¥æ­£å¸¸å·¥ä½œ
                    </div>
                `;
                
            } catch (error) {
                console.error('âŒ å®Œæ•´æµç¨‹æ¸¬è©¦å¤±æ•—:', error);
                document.getElementById('result').innerHTML = `
                    <div style="color: red; padding: 10px; border: 1px solid red;">
                        âŒ å®Œæ•´æµç¨‹æ¸¬è©¦å¤±æ•—<br>
                        éŒ¯èª¤: ${error.message}
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
